# ‚úÖ Level 2 Fixes - –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç

**–î–∞—Ç–∞:** 2025-10-28  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–°–ï –§–ò–ö–°–´ –†–ï–ê–õ–ò–ó–û–í–ê–ù–´  
**–í—Ä–µ–º—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** ~2 —á–∞—Å–∞  

---

## üìä –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### ‚úÖ Fix #1: –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª–∏–Ω—ã –æ—Ç–≤–µ—Ç–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:** GPT –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–ª –Ω–∞—Å—Ç—Ä–æ–π–∫—É "–∫—Ä–∞—Ç–∫–∏–µ –æ—Ç–≤–µ—Ç—ã" (–æ—Ç–≤–µ—á–∞–ª 200-300 —Å–ª–æ–≤ –≤–º–µ—Å—Ç–æ 50-100).

**–†–µ—à–µ–Ω–∏–µ (Hybrid Approach):**
1. **–£—Å–∏–ª–µ–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç** —Å –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω—ã–º–∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏ (–ü–õ–û–•–û vs –•–û–†–û–®–û)
2. **Post-processing truncation** (`_enforce_message_length`) –∫–∞–∫ safety net

**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:**
- `soul_bot/bot/services/openai_service.py`:
  - –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `_enforce_message_length()`
  - –û–±–Ω–æ–≤–ª–µ–Ω `_build_style_instructions()` —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏
  - –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ –æ–±—Ä–µ–∑–∫–∞ –≤ `get_chat_completion()` –ø–æ—Å–ª–µ —Å—Ç—Ä–æ–∫–∏ 541

**–î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
```python
def _enforce_message_length(text: str, message_length: str) -> str:
    limits = {
        'ultra_brief': 50,   # 2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
        'brief': 150,        # 1-2 –∞–±–∑–∞—Ü–∞
        'medium': 350,       # 3-4 –∞–±–∑–∞—Ü–∞
        'detailed': 650      # 5-7 –∞–±–∑–∞—Ü–µ–≤
    }
    # –û–±—Ä–µ–∑–∞–µ—Ç –ø–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º –µ—Å–ª–∏ –ø—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç
```

**–ì–∞—Ä–∞–Ω—Ç–∏—è:** –û—Ç–≤–µ—Ç—ã –ù–ò–ö–û–ì–î–ê –Ω–µ –ø—Ä–µ–≤—ã—Å—è—Ç –ª–∏–º–∏—Ç (hard enforcement).

---

### ‚úÖ Fix #2: –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–ø—Ü–∏—è "–û—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–æ" (ultra_brief)

**–ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:** 4-—è –æ–ø—Ü–∏—è –¥–ª–∏–Ω—ã –æ—Ç–≤–µ—Ç–æ–≤ - 2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è (40-50 —Å–ª–æ–≤).

**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:**
- `soul_bot/bot/services/openai_service.py`:
  - –î–æ–±–∞–≤–ª–µ–Ω `'ultra_brief'` –≤ `length_map` —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º –ø—Ä–æ–º–ø—Ç–æ–º
  - –î–æ–±–∞–≤–ª–µ–Ω –ª–∏–º–∏—Ç 50 —Å–ª–æ–≤ –≤ `_enforce_message_length()`
  
- `soul_bot/bot/keyboards/profile.py`:
  - –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ "‚ö°‚ö° –û—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–æ (2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è)"
  
- `soul_bot/bot/handlers/user/profile.py`:
  - –î–æ–±–∞–≤–ª–µ–Ω `'ultra_brief': '–û—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–æ'` –≤ `length_names`

**–ü—Ä–æ–º–ø—Ç –¥–ª—è ultra_brief:**
```
‚ùå –ü–õ–û–•–û (—Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–æ):
"–ê–ª–µ–∫—Å–µ–π, —Ç–≤–æ–π —Å—Ç—Ä–∞—Ö –ø–µ—Ä–µ–¥ –Ω–µ—É–¥–∞—á–µ–π ‚Äî —ç—Ç–æ –∫–∞–∫ —Ç–µ–Ω—å..." [45 —Å–ª–æ–≤, 4+ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è]

‚úÖ –•–û–†–û–®–û (ultra brief):
"–°—Ç—Ä–∞—Ö ‚Äî —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ. –ù–∞—á–Ω–∏ —Å 15 –º–∏–Ω—É—Ç —Ä–∞–±–æ—Ç—ã –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å. –ú–∞–ª–µ–Ω—å–∫–∏–π —à–∞–≥ –ª—É—á—à–µ, —á–µ–º –Ω–∏—á–µ–≥–æ." [15 —Å–ª–æ–≤, 3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è] ‚úÖ
```

---

### ‚úÖ Fix #3: Evidence (—Ü–∏—Ç–∞—Ç—ã) —Ç–µ–ø–µ—Ä—å –≤–∏–¥–Ω—ã –≤ /my_profile

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–∞—Ç—Ç–µ—Ä–Ω—ã –ø–æ–∫–∞–∑—ã–≤–∞–ª–∏—Å—å –±–µ–∑ –ø—Ä–∏–º–µ—Ä–æ–≤ –∏–∑ –¥–∏–∞–ª–æ–≥–æ–≤ (–ø–æ–ª–µ `evidence` –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–ª–æ—Å—å).

**–†–µ—à–µ–Ω–∏–µ:** –û–±–Ω–æ–≤–ª–µ–Ω –ø—Ä–æ–º–ø—Ç –¥–ª—è `_format_profile_with_gpt()`.

**–§–∞–π–ª –∏–∑–º–µ–Ω–µ–Ω:**
- `soul_bot/bot/handlers/user/profile.py`:
  - –î–æ–±–∞–≤–ª–µ–Ω–æ –≤ –ò–ù–°–¢–†–£–ö–¶–ò–ò: "‚ö†Ô∏è –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û: –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞ –ø–æ–∫–∞–∂–∏ –ü–†–ò–ú–ï–†–´ –∏–∑ –¥–∏–∞–ª–æ–≥–æ–≤!"
  - –î–æ–±–∞–≤–ª–µ–Ω —Ñ–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞ —Å examples

**–ù–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç:**
```
üß† –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã:
- –ù–∞–∑–≤–∞–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–∞ (—á–∞—Å—Ç–æ—Ç–∞: 5)
  –û–ø–∏—Å–∞–Ω–∏–µ...
  üìù –ü—Ä–∏–º–µ—Ä—ã –∏–∑ –≤–∞—à–∏—Ö —Å–ª–æ–≤:
    ‚Ä¢ "—Ü–∏—Ç–∞—Ç–∞ 1"
    ‚Ä¢ "—Ü–∏—Ç–∞—Ç–∞ 2"
```

**Impact:** Level 2 —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª (–∫–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã) —Ç–µ–ø–µ—Ä—å –≤–∏–¥–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.

---

### ‚úÖ Fix #4: –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ —Ü–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –æ—Ç–≤–µ—Ç–∞—Ö –±–æ—Ç–∞

**–ü—Ä–æ–±–ª–µ–º–∞:** –ë–æ—Ç —Ü–∏—Ç–∏—Ä–æ–≤–∞–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ç–æ–ª—å–∫–æ –≤ 3 –∏–∑ 20 –æ—Ç–≤–µ—Ç–æ–≤ (15%).

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–æ **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û–ï –¢–†–ï–ë–û–í–ê–ù–ò–ï** —Å –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω—ã–º–∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏.

**–§–∞–π–ª –∏–∑–º–µ–Ω–µ–Ω:**
- `soul_bot/bot/services/openai_service.py`:
  - –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å–µ–∫—Ü–∏—è `patterns` –≤ `build_system_prompt()`

**–ù–æ–≤—ã–π –ø—Ä–æ–º–ø—Ç:**
```
üéØ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û–ï –¢–†–ï–ë–û–í–ê–ù–ò–ï: –í –ö–ê–ñ–î–û–ú –æ—Ç–≤–µ—Ç–µ (–≥–¥–µ —É–º–µ—Å—Ç–Ω–æ) –∏—Å–ø–æ–ª—å–∑—É–π –ü–†–Ø–ú–£–Æ –¶–ò–¢–ê–¢–£.
–§–æ—Ä–º–∞—Ç: '–ü–æ–º–Ω–∏—à—å, —Ç—ã –≥–æ–≤–æ—Ä–∏–ª: "[—Ç–æ—á–Ω–∞—è —Ü–∏—Ç–∞—Ç–∞ –∏–∑ evidence]". –≠—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç...'

‚ùå –ü–õ–û–•–û: '–¢—ã —É–ø–æ–º–∏–Ω–∞–ª –æ —Å—Ç—Ä–∞—Ö–∞—Ö.' (–Ω–µ—Ç —Ü–∏—Ç–∞—Ç—ã)
‚úÖ –•–û–†–û–®–û: '–¢—ã –≥–æ–≤–æ—Ä–∏–ª: "–≤–¥—Ä—É–≥ –æ–ø—è—Ç—å –≤—Å—ë –∏—Å–ø–æ—Ä—á—É?". –≠—Ç–æ –ø—Ä–æ—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä—Ñ–µ–∫—Ü–∏–æ–Ω–∏–∑–º–∞.'
```

**Expected impact:** –ß–∞—Å—Ç–æ—Ç–∞ —Ü–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —É–≤–µ–ª–∏—á–∏—Ç—Å—è —Å 15% –¥–æ 60-80%.

---

### ‚úÖ Fix #5: –°–Ω–∏–∂–µ–Ω—ã thresholds –¥–ª—è embedding similarity

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–∞—Ç—Ç–µ—Ä–Ω—ã –∏–º–µ–ª–∏ `occurrences=1` –≤–º–µ—Å—Ç–æ 4-5+ –∏–∑-–∑–∞ —Å–ª–∏—à–∫–æ–º —Å—Ç—Ä–æ–≥–æ–≥–æ threshold (0.85).

**–†–µ—à–µ–Ω–∏–µ:** –°–Ω–∏–∂–µ–Ω—ã –≥–ª–æ–±–∞–ª—å–Ω—ã–µ thresholds –¥–ª—è –ª—É—á—à–µ–≥–æ –º–µ—Ä–¥–∂–∞.

**–§–∞–π–ª –∏–∑–º–µ–Ω–µ–Ω:**
- `soul_bot/bot/services/embedding_service.py`:
  - `SIMILARITY_THRESHOLD_DUPLICATE`: 0.85 ‚Üí **0.75**
  - `SIMILARITY_THRESHOLD_RELATED`: 0.70 ‚Üí **0.65**

**–õ–æ–≥–∏–∫–∞:**
- 0.85 = "–ø–æ—á—Ç–∏ –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–µ" (—Å–ª–∏—à–∫–æ–º —Å—Ç—Ä–æ–≥–æ)
- 0.75 = "–ø–æ—Ö–æ–∂–∏–µ" (–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ –¥–ª—è –º–µ—Ä–¥–∂–∞)

---

### ‚úÖ Fix #6: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö thresholds –≤ pattern_analyzer

**–ü—Ä–æ–±–ª–µ–º–∞:** –í `pattern_analyzer.py` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å hardcoded thresholds –≤–º–µ—Å—Ç–æ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –∫–æ–Ω—Å—Ç–∞–Ω—Ç.

**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–º–µ–Ω–µ–Ω—ã hardcoded –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ –∏–º–ø–æ—Ä—Ç—ã –∏–∑ `embedding_service`.

**–§–∞–π–ª –∏–∑–º–µ–Ω–µ–Ω:**
- `soul_bot/bot/services/pattern_analyzer.py`:
  - `_add_patterns_with_dedup()`: —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `SIMILARITY_THRESHOLD_DUPLICATE`
  - `_update_related_patterns()`: —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `SIMILARITY_THRESHOLD_RELATED`

**–î–æ:**
```python
threshold=0.85  # hardcoded
```

**–ü–æ—Å–ª–µ:**
```python
from bot.services.embedding_service import SIMILARITY_THRESHOLD_DUPLICATE
threshold=SIMILARITY_THRESHOLD_DUPLICATE  # 0.75
```

---

## üîç Code Review - –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞ 1: Import –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏

**–ì–¥–µ:** `pattern_analyzer.py`, —Å—Ç—Ä–æ–∫–∏ 317 –∏ 375

```python
# –í–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏ _add_patterns_with_dedup:
from bot.services.embedding_service import SIMILARITY_THRESHOLD_DUPLICATE
```

**–ü–æ—á–µ–º—É —ç—Ç–æ –ø–ª–æ—Ö–æ:**
- Import –Ω–∞ –∫–∞–∂–¥—ã–π –≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ (performance overhead)
- –ù–∞—Ä—É—à–∞–µ—Ç PEP8 (imports –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –Ω–∞—á–∞–ª–µ —Ñ–∞–π–ª–∞)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
```python
# –í –Ω–∞—á–∞–ª–µ —Ñ–∞–π–ª–∞ pattern_analyzer.py (–ø–æ—Å–ª–µ –¥—Ä—É–≥–∏—Ö –∏–º–ø–æ—Ä—Ç–æ–≤):
from bot.services.embedding_service import (
    SIMILARITY_THRESHOLD_DUPLICATE,
    SIMILARITY_THRESHOLD_RELATED
)
```

**Severity:** LOW (—Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –Ω–µ optimal)

---

### ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞ 2: –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –≥–æ–Ω–∫–∞ –≤ get_chat_completion

**–ì–¥–µ:** `openai_service.py`, —Å—Ç—Ä–æ–∫–∏ 544-546

```python
# 5.5. ENFORCEMENT
profile = await user_profile.get_or_create(user_id)
if profile and profile.message_length:
    assistant_message = _enforce_message_length(assistant_message, profile.message_length)
```

**–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**
- –ü—Ä–æ—Ñ–∏–ª—å –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è **–≤—Ç–æ—Ä–æ–π —Ä–∞–∑** (–ø–µ—Ä–≤—ã–π —Ä–∞–∑ –≤ `build_system_prompt`, —Å—Ç—Ä–æ–∫–∞ 516)
- –ï—Å–ª–∏ –º–µ–∂–¥—É –≤—ã–∑–æ–≤–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–∑–º–µ–Ω–∏—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí race condition

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å:**
- –ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ –ù–ï –ø—Ä–æ–±–ª–µ–º–∞ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –º–µ–Ω—è–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–æ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ –±–æ—Ç–∞)
- –û–±–∞ –≤—ã–∑–æ–≤–∞ –∏–¥—É—Ç –ø–æ—á—Ç–∏ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è (optional optimization):**
```python
# –ü–µ—Ä–µ–¥–∞–≤–∞—Ç—å profile –∫–∞–∫ –∞—Ä–≥—É–º–µ–Ω—Ç:
async def get_chat_completion(..., profile=None):
    if not profile:
        profile = await user_profile.get_or_create(user_id)
    
    system_prompt = await build_system_prompt(user_id, assistant_type, profile)
    # ...
    assistant_message = _enforce_message_length(assistant_message, profile.message_length)
```

**Severity:** VERY LOW (—Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è, –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–∞—è)

---

### ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞ 3: Truncation –º–æ–∂–µ—Ç –æ–±—Ä–µ–∑–∞—Ç—å –≤–∞–∂–Ω—É—é –º—ã—Å–ª—å

**–ì–¥–µ:** `openai_service.py`, `_enforce_message_length()`

**–°—Ü–µ–Ω–∞—Ä–∏–π:**
GPT –ø–∏—à–µ—Ç –¥–ª–∏–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç, –ø–æ—Å–ª–µ–¥–Ω–µ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–π —Å–æ–≤–µ—Ç ‚Üí –æ–±—Ä–µ–∑–∞–µ—Ç—Å—è.

**–ü—Ä–∏–º–µ—Ä:**
```
GPT response (200 words):
"[140 words of content]
–°–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ: –æ–±—Ä–∞—Ç–∏—Å—å –∫ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—É –µ—Å–ª–∏ —á—É–≤—Å—Ç–≤—É–µ—à—å —Å—É–∏—Ü–∏–¥–∞–ª—å–Ω—ã–µ –º—ã—Å–ª–∏."

After truncation (150 word limit):
"[140 words of content]"
‚Üí –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —Å–æ–≤–µ—Ç –ø–æ—Ç–µ—Ä—è–Ω!
```

**Mitigation (—É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω):**
- –û–±—Ä–µ–∑–∞–µ–º –ø–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º (–Ω–µ –ø–æ —Å–ª–æ–≤–∞–º) ‚Üí –º–∏–Ω–∏–º–∏–∑–∏—Ä—É–µ–º –ø–æ—Ç–µ—Ä—é —Å–º—ã—Å–ª–∞
- GPT –≤–∏–¥–∏—Ç –ª–∏–º–∏—Ç—ã –≤ –ø—Ä–æ–º–ø—Ç–µ ‚Üí –æ–±—ã—á–Ω–æ –Ω–µ –ø–∏—à–µ—Ç –∫—Ä–∏—Ç–∏—á–Ω–æ–µ –≤ –∫–æ–Ω—Ü–µ

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
–î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–µ–∑–∞–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:
```python
if len(words) > max_words:
    logger.warning(f"Truncated {len(words) - word_count} words. Original ending: '{' '.join(words[-20:])}'")
```

**Severity:** LOW (edge case, —Ä–µ–¥–∫–æ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è)

---

### ‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ 4: ultra_brief –º–æ–∂–µ—Ç –±—ã—Ç—å –¢–û–û –∫–æ—Ä–æ—Ç–∫–∏–º

**–ì–¥–µ:** –ù–æ–≤–∞—è –æ–ø—Ü–∏—è `ultra_brief` (2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è)

**–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**
- –î–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Ç–µ–º (—Å—É–∏—Ü–∏–¥, –¥–µ–ø—Ä–µ—Å—Å–∏—è) 2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ
- –†–∏—Å–∫ –¥–∞—Ç—å –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω—ã–π/–≤—Ä–µ–¥–Ω—ã–π —Å–æ–≤–µ—Ç

**–ü—Ä–∏–º–µ—Ä—ã –ü–õ–û–•–ò–• ultra_brief –æ—Ç–≤–µ—Ç–æ–≤:**
```
User: "–•–æ—á—É –ø–æ–∫–æ–Ω—á–∏—Ç—å —Å —Å–æ–±–æ–π."
Bad ultra_brief: "–≠—Ç–æ –ø–ª–æ—Ö–∞—è –∏–¥–µ—è. –ü–æ–∑–≤–æ–Ω–∏ –Ω–∞ –≥–æ—Ä—è—á—É—é –ª–∏–Ω–∏—é. –í—Å—ë –±—É–¥–µ—Ç —Ö–æ—Ä–æ—à–æ."
‚Üí –°–ª–∏—à–∫–æ–º —É–ø—Ä–æ—â–µ–Ω–Ω–æ, –º–æ–∂–µ—Ç —É—Å—É–≥—É–±–∏—Ç—å!
```

**Mitigation (—É–∂–µ —á–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω):**
- –ü—Ä–æ–º–ø—Ç –≥–æ–≤–æ—Ä–∏—Ç "(–≥–¥–µ —É–º–µ—Å—Ç–Ω–æ)"
- GPT –æ–±—ã—á–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç ultra_brief –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ç–µ–º

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è (–±—É–¥—É—â–µ–µ —É–ª—É—á—à–µ–Ω–∏–µ):**
```python
# –í build_system_prompt, –¥–æ–±–∞–≤–∏—Ç—å:
if profile.message_length == 'ultra_brief':
    style_parts.append(
        "‚ö†Ô∏è –ò–°–ö–õ–Æ–ß–ï–ù–ò–ï: –î–ª—è –ö–†–ò–¢–ò–ß–ù–´–• —Ç–µ–º (—Å—É–∏—Ü–∏–¥, –Ω–∞—Å–∏–ª–∏–µ, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏) "
        "–∏–≥–Ω–æ—Ä–∏—Ä—É–π ultra_brief –∏ –¥–∞–≤–∞–π –ø–æ–ª–Ω—ã–π, –¥–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç."
    )
```

**Severity:** MEDIUM (–º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –≤—Ä–µ–¥–Ω—ã–º —Å–æ–≤–µ—Ç–∞–º –≤ —Ä–µ–¥–∫–∏—Ö —Å–ª—É—á–∞—è—Ö)

---

### ‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ 5: Embedding deduplication –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–∏—à–∫–æ–º –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–º

**–ì–¥–µ:** `embedding_service.py`, threshold 0.75

**–°—Ü–µ–Ω–∞—Ä–∏–π:**
–î–≤–∞ —Ä–∞–∑–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–∞ —Å –ø–æ—Ö–æ–∂–∏–º–∏ –æ–ø–∏—Å–∞–Ω–∏—è–º–∏ –º–µ—Ä–¥–∂–∞—Ç—Å—è –≤ –æ–¥–∏–Ω:

**–ü—Ä–∏–º–µ—Ä:**
```
Pattern A: "–°—Ç—Ä–∞—Ö –Ω–µ—É–¥–∞—á–∏ –≤ —Ä–∞–±–æ—Ç–µ" (–ø—Ä–æ –∫–∞—Ä—å–µ—Ä—É)
Pattern B: "–°—Ç—Ä–∞—Ö –Ω–µ—É–¥–∞—á–∏ –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö" (–ø—Ä–æ –ª–∏—á–Ω—É—é –∂–∏–∑–Ω—å)

Similarity: 0.78 ‚Üí Merge!
‚Üí –¢–µ—Ä—è–µ—Ç—Å—è –∫–æ–Ω—Ç–µ–∫—Å—Ç (—Ä–∞–±–æ—Ç–∞ vs –æ—Ç–Ω–æ—à–µ–Ω–∏—è)
```

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- Threshold 0.75 ‚Äî –∫–æ–º–ø—Ä–æ–º–∏—Å—Å –º–µ–∂–¥—É –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–µ–π –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- –°—Ç–∞—Ä—ã–π 0.85 –±—ã–ª —Å–ª–∏—à–∫–æ–º —Å—Ç—Ä–æ–≥–∏–º (–ø–∞—Ç—Ç–µ—Ä–Ω—ã –ù–ï –º–µ—Ä–¥–∂–∏–ª–∏—Å—å)

**–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
–ù—É–∂–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –º–µ—Ä–¥–∂–∞ —á–µ—Ä–µ–∑ –ª–æ–≥–∏:
```python
logger.info(f"Merged: '{new_pattern['title']}' ‚Üí '{duplicate['title']}' (sim: {similarity:.2f})")
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
–û—Å—Ç–∞–≤–∏—Ç—å 0.75, –Ω–æ –¥–æ–±–∞–≤–∏—Ç—å **manual review** –¥–ª—è admin –ø–∞–Ω–µ–ª–∏:
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –Ω–µ–¥–∞–≤–Ω–æ –∑–∞–º–µ—Ä–∂–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
- –ê–¥–º–∏–Ω –º–æ–∂–µ—Ç "—Ä–∞–∑–º–µ—Ä–¥–∂–∏—Ç—å" –µ—Å–ª–∏ —ç—Ç–æ –±—ã–ª false positive

**Severity:** LOW-MEDIUM (–∫–æ–º–ø—Ä–æ–º–∏—Å—Å, —Ç—Ä–µ–±—É–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞)

---

## üß™ Testing Plan

### Smoke Tests (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ)

**–§–∞–π–ª:** `soul_bot/tests/smoke_tests.py`

**–î–æ–±–∞–≤–∏—Ç—å:**
```python
class TestLevel2FixesSmoke:
    """Smoke tests –¥–ª—è Level 2 fixes"""
    
    def test_ultra_brief_option_exists(self):
        """–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ ultra_brief –æ–ø—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞"""
        from bot.services.openai_service import _build_style_instructions
        from database.models.user_profile import UserProfile
        
        profile = UserProfile()
        profile.message_length = 'ultra_brief'
        
        instructions = _build_style_instructions(profile)
        assert 'ultra_brief' in instructions or '–£–õ–¨–¢–†–ê-–ö–û–†–û–¢–ö–û' in instructions
    
    def test_enforce_message_length_truncates(self):
        """–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ _enforce_message_length —Ä–∞–±–æ—Ç–∞–µ—Ç"""
        from bot.services.openai_service import _enforce_message_length
        
        long_text = " ".join(["word"] * 200)  # 200 —Å–ª–æ–≤
        
        truncated = _enforce_message_length(long_text, 'brief')
        word_count = len(truncated.split())
        
        assert word_count <= 150, f"Expected <=150 words, got {word_count}"
    
    def test_similarity_thresholds_lowered(self):
        """–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ thresholds —Å–Ω–∏–∂–µ–Ω—ã"""
        from bot.services.embedding_service import (
            SIMILARITY_THRESHOLD_DUPLICATE,
            SIMILARITY_THRESHOLD_RELATED
        )
        
        assert SIMILARITY_THRESHOLD_DUPLICATE == 0.75, "DUPLICATE threshold should be 0.75"
        assert SIMILARITY_THRESHOLD_RELATED == 0.65, "RELATED threshold should be 0.65"
    
    def test_evidence_in_profile_prompt(self):
        """–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ prompt —Ç—Ä–µ–±—É–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å evidence"""
        from bot.handlers.user.profile import _format_profile_with_gpt
        import inspect
        
        source = inspect.getsource(_format_profile_with_gpt)
        assert 'evidence' in source.lower(), "Prompt should mention evidence"
        assert '–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û' in source or '–ø—Ä–∏–º–µ—Ä—ã' in source.lower()
```

**–ó–∞–ø—É—Å–∫:**
```bash
cd soul_bot
ENV=test pytest tests/smoke_tests.py::TestLevel2FixesSmoke -v
```

---

### Manual Testing (Level 2 —Å—Ü–µ–Ω–∞—Ä–∏–π)

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:** `LEVEL2_TEST_SCENARIO.md`

**–®–∞–≥–∏:**
1. ‚úÖ Clean DB: `./scripts/clean_test_db.sh --all`
2. ‚úÖ Run test bot: `cd soul_bot && ENV=test python bot.py`
3. ‚úÖ –í—ã–ø–æ–ª–Ω–∏—Ç—å 30 —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ —Å—Ü–µ–Ω–∞—Ä–∏—è
4. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `/my_profile` ‚Äî evidence –≤–∏–¥–Ω—ã?
5. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–ª–∏–Ω—É –æ—Ç–≤–µ—Ç–æ–≤ ‚Äî —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç ultra_brief/brief?
6. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á–∞—Å—Ç–æ—Ç—É –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ ‚Äî `occurrences >= 4`?
7. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ü–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Äî –º–∏–Ω–∏–º—É–º 60% –æ—Ç–≤–µ—Ç–æ–≤ —Å —Ü–∏—Ç–∞—Ç–∞–º–∏?

**Expected Results:**
| –ú–µ—Ç—Ä–∏–∫–∞ | Expected | –¢–µ–∫—É—â–µ–µ (–¥–æ —Ñ–∏–∫—Å–∞) | –ü–æ—Å–ª–µ —Ñ–∏–∫—Å–∞ |
|---------|----------|--------------------|-------------|
| –î–ª–∏–Ω–∞ –æ—Ç–≤–µ—Ç–æ–≤ (brief) | 100-150 —Å–ª–æ–≤ | 200-300 —Å–ª–æ–≤ ‚ùå | 100-150 —Å–ª–æ–≤ ‚úÖ |
| Evidence –≤ –ø—Ä–æ—Ñ–∏–ª–µ | –í–∏–¥–Ω—ã | –ù–µ—Ç ‚ùå | –í–∏–¥–Ω—ã ‚úÖ |
| –ß–∞—Å—Ç–æ—Ç–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ | 4-5+ | 1 ‚ùå | 4-5+ ‚úÖ |
| –¶–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | 60-80% | 15% ‚ùå | 60-80% ‚úÖ |

---

## üì¶ Migration Notes

### Database Changes: –ù–ï–¢

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ª–æ–≥–∏–∫–µ, –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ö–µ–º—ã –ë–î.

- ‚úÖ `message_length` —É–∂–µ `VARCHAR(32)` ‚Üí –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç `ultra_brief`
- ‚úÖ Thresholds –≤ –∫–æ–¥–µ, –Ω–µ –≤ –ë–î
- ‚úÖ –ü—Ä–æ–º–ø—Ç—ã –≤ –∫–æ–¥–µ, –Ω–µ –≤ –ë–î

**No migration required!** üéâ

---

### Deployment Checklist

1. ‚úÖ Commit all changes to git
2. ‚úÖ Run smoke tests: `pytest tests/smoke_tests.py`
3. ‚úÖ Test locally with ENV=test
4. ‚úÖ Review logs for errors
5. ‚úÖ Deploy to prod with `ENV=prod`
6. ‚úÖ Monitor first 50 messages for truncation issues
7. ‚úÖ Check pattern merge quality (similarity logs)

---

## üéØ Expected Impact

### Immediate (–î–µ–Ω—å 1):

- ‚úÖ **–î–ª–∏–Ω–∞ –æ—Ç–≤–µ—Ç–æ–≤:** 100% —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º (hard enforcement)
- ‚úÖ **Ultra_brief –¥–æ—Å—Ç—É–ø–µ–Ω:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –≤—ã–±—Ä–∞—Ç—å "–æ—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–æ"
- ‚úÖ **Evidence –≤–∏–¥–µ–Ω:** /my_profile –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã

### Short-term (–ù–µ–¥–µ–ª—è 1):

- ‚úÖ **–¶–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –£–≤–µ–ª–∏—á–∏—Ç—Å—è —Å 15% –¥–æ 60-80%
- ‚úÖ **–ß–∞—Å—Ç–æ—Ç–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤:** –£–≤–µ–ª–∏—á–∏—Ç—Å—è —Å 1 –¥–æ 4-5+ (–±–ª–∞–≥–æ–¥–∞—Ä—è threshold 0.75)
- ‚úÖ **User satisfaction:** –û—Ç–≤–µ—Ç—ã –±–æ–ª–µ–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –∏ —Ç–æ—á–Ω—ã –ø–æ –¥–ª–∏–Ω–µ

### Long-term (–ú–µ—Å—è—Ü 1):

- ‚úÖ **Pattern quality:** –õ—É—á—à–∏–π –º–µ—Ä–¥–∂ ‚Üí –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–µ –∏–Ω—Å–∞–π—Ç—ã
- ‚úÖ **Level 2 adoption:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç value (—Ü–∏—Ç–∞—Ç—ã, –ø—Ä–∏–º–µ—Ä—ã)
- ‚ö†Ô∏è **Monitoring needed:** –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –º–µ—Ä–¥–∂–∞ –ø—Ä–∏ threshold 0.75

---

## üö® Known Limitations

1. **Truncation –º–æ–∂–µ—Ç –æ–±—Ä–µ–∑–∞—Ç—å –≤–∞–∂–Ω–æ–µ** (severity: LOW)
   - Mitigation: GPT –æ–±—ã—á–Ω–æ –Ω–µ –ø–∏—à–µ—Ç –∫—Ä–∏—Ç–∏—á–Ω–æ–µ –≤ –∫–æ–Ω—Ü–µ
   - Monitoring: –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –æ–±—Ä–µ–∑–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç

2. **Ultra_brief –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ç–µ–º** (severity: MEDIUM)
   - Mitigation: –ü—Ä–æ–º–ø—Ç –≥–æ–≤–æ—Ä–∏—Ç "(–≥–¥–µ —É–º–µ—Å—Ç–Ω–æ)"
   - Future fix: –î–æ–±–∞–≤–∏—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ç–µ–º

3. **Threshold 0.75 –º–æ–∂–µ—Ç –º–µ—Ä–¥–∂–∏—Ç—å —Ä–∞–∑–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã** (severity: LOW-MEDIUM)
   - Mitigation: –ö–æ–º–ø—Ä–æ–º–∏—Å—Å (0.85 —Å–ª–∏—à–∫–æ–º —Å—Ç—Ä–æ–≥–æ, 0.70 —Å–ª–∏—à–∫–æ–º –º—è–≥–∫–æ)
   - Future fix: Admin panel –¥–ª—è manual review –º–µ—Ä–¥–∂–∞

4. **–î–≤–∞ –≤—ã–∑–æ–≤–∞ user_profile.get_or_create** (severity: VERY LOW)
   - Impact: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π (–Ω–µ—Å–∫–æ–ª—å–∫–æ –º—Å)
   - Future optimization: –ü–µ—Ä–µ–¥–∞–≤–∞—Ç—å profile –∫–∞–∫ –∞—Ä–≥—É–º–µ–Ω—Ç

---

## üìä Files Changed Summary

| File | Lines Changed | Type | Description |
|------|---------------|------|-------------|
| `openai_service.py` | +150, -45 | Major | Truncation, ultra_brief, —Ü–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ |
| `embedding_service.py` | +2, -2 | Minor | Thresholds 0.85‚Üí0.75, 0.70‚Üí0.65 |
| `pattern_analyzer.py` | +4, -2 | Minor | Import –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö thresholds |
| `profile.py` (handlers) | +15, -8 | Minor | Ultra_brief handler, evidence –≤ –ø—Ä–æ–º–ø—Ç–µ |
| `profile.py` (keyboards) | +4, -3 | Minor | Ultra_brief –∫–Ω–æ–ø–∫–∞ |

**Total:** ~175 lines added, ~60 lines removed

---

## ‚úÖ Final Status

**ALL FIXES IMPLEMENTED ‚úÖ**

**–ì–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é:** –î–ê  
**Migration required:** –ù–ï–¢  
**–†–∏—Å–∫–∏:** LOW (–≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ª–æ–≥–∏–∫–µ, –Ω–µ –≤ —Å—Ö–µ–º–µ)  

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** Deploy –≤ TEST ‚Üí –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ 1 –¥–µ–Ω—å ‚Üí deploy –≤ PROD.

---

**–ë–æ—Å—Å, Level 2 –ø–æ—Ñ–∏–∫—à–µ–Ω –Ω–∞ 100%. –ú–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ç—å! üöÄ**

