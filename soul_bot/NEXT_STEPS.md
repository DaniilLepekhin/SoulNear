# üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ –ø–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

## ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∑–∞–≤–µ—Ä—à—ë–Ω!

–í—Å–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã.

---

## üìù –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –¢–ï–ë–ï

### 1. –ó–∞–ø–æ–ª–Ω–∏—Ç—å .env —Ñ–∞–π–ª—ã (5 –º–∏–Ω—É—Ç)

#### –®–∞–≥ 1.1: –°–æ–∑–¥–∞–π .env.prod –∏–∑ —à–∞–±–ª–æ–Ω–∞
```bash
cd /Users/nikitagorokhov/dev/SoulNear/soul_bot
cp .env.prod.TEMPLATE .env.prod
```

#### –®–∞–≥ 1.2: –û—Ç–∫—Ä–æ–π –∏ –∑–∞–ø–æ–ª–Ω–∏ .env.prod
```bash
nano .env.prod  # –∏–ª–∏ code .env.prod
```

–ó–∞–º–µ–Ω–∏ `–í–°–¢–ê–í–¨_–°–Æ–î–ê_...` –Ω–∞ —Å–≤–æ–∏ —Ä–µ–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:
- `BOT_TOKEN` - –æ—Ç @BotFather (–ø—Ä–æ–¥–∞–∫—à–Ω –±–æ—Ç)
- `OPENAI_API_KEY` - –æ—Ç https://platform.openai.com/api-keys
- `POSTGRES_PASSWORD` - –ø–∞—Ä–æ–ª—å –æ—Ç —Ç–≤–æ–µ–π PostgreSQL
- `HELPER_ID`, `SOULSLEEP_ID` –∏ –¥—Ä. - ID –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–≤ –∏–∑ OpenAI Dashboard

#### –®–∞–≥ 1.3: –°–æ–∑–¥–∞–π .env.test –∏–∑ —à–∞–±–ª–æ–Ω–∞
```bash
cp .env.test.TEMPLATE .env.test
```

#### –®–∞–≥ 1.4: –û—Ç–∫—Ä–æ–π –∏ –∑–∞–ø–æ–ª–Ω–∏ .env.test
```bash
nano .env.test  # –∏–ª–∏ code .env.test
```

**–í–Ω–∏–º–∞–Ω–∏–µ:** BOT_TOKEN —É–∂–µ –∑–∞–ø–æ–ª–Ω–µ–Ω —Ç–µ—Å—Ç–æ–≤—ã–º!

–ó–∞–º–µ–Ω–∏ —Ç–æ–ª—å–∫–æ:
- `OPENAI_API_KEY`
- `POSTGRES_PASSWORD`
- Assistant IDs

---

### 2. –ü—Ä–æ–≤–µ—Ä—å —Ä–∞–±–æ—Ç—É (2 –º–∏–Ω—É—Ç—ã)

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
python test_refactoring.py

# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
# üéâ –í–°–ï –ü–†–û–í–ï–†–ö–ò –ü–†–û–ô–î–ï–ù–´!
```

–ï—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∏ - –ø—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –≤—Å–µ —Ç–æ–∫–µ–Ω—ã –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ.

---

### 3. –ó–∞–ø—É—Å—Ç–∏ —Ç–µ—Å—Ç–æ–≤—ã–π –±–æ—Ç (1 –º–∏–Ω—É—Ç–∞)

```bash
ENV=test python bot.py
```

–ó–∞–π–¥–∏ –≤ Telegram, –æ—Ç–ø—Ä–∞–≤—å —Å–æ–æ–±—â–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–º—É –±–æ—Ç—É. –î–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å!

**Ctrl+C** —á—Ç–æ–±—ã –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å.

---

### 4. –ó–∞–ø—É—Å—Ç–∏ –ø—Ä–æ–¥–∞–∫—à–Ω –±–æ—Ç (–û–°–¢–û–†–û–ñ–ù–û!)

```bash
ENV=prod python bot.py
```

–ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –ø—Ä–æ–¥–∞–∫—à–Ω –±–æ—Ç —Ç–æ–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç.

**Ctrl+C** —á—Ç–æ–±—ã –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å.

---

### 5. –£–¥–∞–ª–∏ —Å—Ç–∞—Ä—ã–µ —Ñ–∞–π–ª—ã (1 –º–∏–Ω—É—Ç–∞)

**–¢–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ —É–±–µ–¥–∏—à—å—Å—è, —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç!**

```bash
cd /Users/nikitagorokhov/dev/SoulNear

# –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—É—é –ø–∞–ø–∫—É
rm -rf soul_test_bot

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: —É–¥–∞–ª—è–µ–º –±—ç–∫–∞–ø—ã (–º–æ–∂–µ—à—å –æ—Å—Ç–∞–≤–∏—Ç—å –Ω–∞ –Ω–µ–¥–µ–ª—é)
rm -rf soul_bot_backup soul_test_bot_backup

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: —É–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–π config
rm -f soul_bot/config_old.py
```

**–û—Å–≤–æ–±–æ–¥–∏—Ç—Å—è:** ~38 –ú–ë

---

### 6. –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è (1 –º–∏–Ω—É—Ç–∞)

```bash
cd soul_bot
git status
git add .
git commit -m "refactor: unified soul_bot and soul_test_bot with .env configs

- Merged soul_bot and soul_test_bot into single codebase
- Added .env.prod and .env.test for environment configs
- Updated config.py to support multiple environments
- Copied webapp.py from soul_test_bot
- Created tests and documentation
- Improved security (tokens in .env, not in code)"

git push
```

---

## üöÄ –ì–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä—å –º–æ–∂–µ—à—å:

‚úÖ –ó–∞–ø—É—Å–∫–∞—Ç—å prod –∏ test –∏–∑ –æ–¥–Ω–æ–π –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã  
‚úÖ –õ–µ–≥–∫–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É –æ–∫—Ä—É–∂–µ–Ω–∏—è–º–∏  
‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–∫–µ–Ω—ã  
‚úÖ –ù–∞—á–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –Ω–∞ ChatCompletion API  

---

## üìö –°–ø—Ä–∞–≤–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –ó–∞–ø—É—Å–∫:
```bash
# –ü—Ä–æ–¥–∞–∫—à–Ω
ENV=prod python bot.py
# –∏–ª–∏
../scripts/run_prod.sh

# –¢–µ—Å—Ç
ENV=test python bot.py
# –∏–ª–∏
../scripts/run_test.sh
```

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- `README_REFACTORING.md` - Quick Start
- `SETUP_ENV.md` - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ .env
- `REFACTORING_DONE.md` - –î–µ—Ç–∞–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- `REFACTORING_SUMMARY.md` - –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á—ë—Ç

### –ü—Ä–æ–±–ª–µ–º—ã?
1. –ü—Ä–æ—á–∏—Ç–∞–π `SETUP_ENV.md`
2. –ó–∞–ø—É—Å—Ç–∏ `python test_refactoring.py`
3. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏: `tail -f log.txt`

---

## ‚ùì FAQ

**Q: –ì–¥–µ –≤–∑—è—Ç—å —Ç–æ–∫–µ–Ω—ã?**
- BOT_TOKEN: @BotFather –≤ Telegram
- OPENAI_API_KEY: https://platform.openai.com/api-keys
- Assistant IDs: https://platform.openai.com/assistants

**Q: –ú–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –æ–±–∞ –±–æ—Ç–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ?**
- –î–∞! –û–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ä–∞–∑–Ω—ã–µ –ë–î.

**Q: –ß—Ç–æ –¥–µ–ª–∞—Ç—å –µ—Å–ª–∏ —Å–ª–æ–º–∞–ª–æ—Å—å?**
- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏ –∏–∑ –±—ç–∫–∞–ø–∞: `cp -r soul_bot_backup soul_bot`

**Q: –ì–¥–µ —Ö—Ä–∞–Ω–∏—Ç—å .env —Ñ–∞–π–ª—ã?**
- –õ–æ–∫–∞–ª—å–Ω–æ –Ω–∞ –º–∞—à–∏–Ω–µ, –Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—å –≤ git!

---

## üéì –ß—Ç–æ –¥–∞–ª—å—à–µ?

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —ç—Ç–∏—Ö —à–∞–≥–æ–≤ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ **–º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ ChatCompletion API** –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–æ–≤—ã—Ö —Ñ–∏—á!

–°–º. –ø–ª–∞–Ω –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞.
