# ‚úÖ Docker Setup Checklist

## –ü–µ—Ä–µ–¥ –ø–µ—Ä–≤—ã–º –∑–∞–ø—É—Å–∫–æ–º

- [ ] Docker –∏ Docker Compose —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
  ```bash
  docker --version
  docker-compose --version
  ```

- [ ] –°–æ–∑–¥–∞–Ω –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª
  ```bash
  make setup
  # –∏–ª–∏
  cp .env.example .env.prod
  ```

- [ ] –ó–∞–ø–æ–ª–Ω–µ–Ω—ã –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ `.env.prod`:
  - [ ] `BOT_TOKEN` - —Ç–æ–∫–µ–Ω –æ—Ç @BotFather
  - [ ] `OPENAI_API_KEY` - –∫–ª—é—á OpenAI API
  - [ ] `POSTGRES_PASSWORD` - –Ω–∞–¥–µ–∂–Ω—ã–π –ø–∞—Ä–æ–ª—å –¥–ª—è –ë–î

- [ ] –ó–∞–ø–æ–ª–Ω–µ–Ω—ã OpenAI Assistants (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è):
  - [ ] `HELPER_ID`
  - [ ] `SOULSLEEP_ID`
  - [ ] `RELATIONSHIPS_ID`
  - [ ] `MONEY_ID`
  - [ ] `CONFIDENCE_ID`
  - [ ] `FEARS_ID`

- [ ] –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
  - [ ] `SHOP_ID` –∏ `SECRET_KEY` (YooKassa –¥–ª—è –ø–ª–∞—Ç–µ–∂–µ–π)
  - [ ] `ELEVEN_LABS_KEY` (–≥–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è)

## –ó–∞–ø—É—Å–∫

- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
  ```bash
  ./validate-env.sh
  ```

- [ ] –°–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑—ã
  ```bash
  make build
  ```

- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
  ```bash
  make up
  ```

- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
  ```bash
  make ps
  ```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

- [ ] PostgreSQL –∑–∞–ø—É—â–µ–Ω –∏ –∑–¥–æ—Ä–æ–≤
  ```bash
  docker exec soulnear_postgres pg_isready -U postgres
  ```

- [ ] –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
  ```bash
  make logs-bot
  # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: "üöÄ –ó–∞–≥—Ä—É–∂–µ–Ω –∫–æ–Ω—Ñ–∏–≥: .env.prod"
  # –ò –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—à–∏–±–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
  ```

- [ ] API –∑–∞–ø—É—â–µ–Ω –∏ –æ—Ç–≤–µ—á–∞–µ—Ç
  ```bash
  curl http://localhost:8888/health
  # –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å JSON —Å status: "healthy"
  ```

- [ ] –ù–∞–ø–∏—Å–∞—Ç—å –±–æ—Ç—É –≤ Telegram
  - [ ] –ë–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç
  - [ ] –ö–æ–º–∞–Ω–¥—ã —Ä–∞–±–æ—Ç–∞—é—Ç
  - [ ] –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ë–æ—Ç –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –ë–î

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
make logs-bot

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
docker exec soulnear_bot env | grep POSTGRES

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ PostgreSQL –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
docker exec soulnear_postgres psql -U postgres -c "SELECT 1"
```

### API –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
make logs-api

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø–æ—Ä—Ç –Ω–µ –∑–∞–Ω—è—Ç
lsof -i :8888

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å API
make restart-api
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è

```bash
# –£–¥–∞–ª–∏—Ç—å –≤—Å—ë –∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å
docker-compose down -v
make up

# –ò–ª–∏ –≤—Ä—É—á–Ω—É—é –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∏ —Å–æ–∑–¥–∞—Ç—å
make shell-db
# –í psql:
# CREATE DATABASE soul_bot;
```

## –ï–∂–µ–¥–Ω–µ–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫
make up

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
make logs

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
make down

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
make rebuild

# –ë—ç–∫–∞–ø –ë–î (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–µ–ª–∞—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω–æ)
make backup
```

## Production –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å

- [ ] `.env.prod` –Ω–µ –∑–∞–∫–æ–º–º–∏—á–µ–Ω –≤ git
- [ ] –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–∏–ª—å–Ω—ã–π –ø–∞—Ä–æ–ª—å –¥–ª—è PostgreSQL
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω —Ä–µ–≥—É–ª—è—Ä–Ω—ã–π –±—ç–∫–∞–ø –ë–î (cron)
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Ä–∞–±–æ—Ç–∞ restart –ø–æ–ª–∏—Ç–∏–∫–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω rotation –ª–æ–≥–æ–≤ Docker

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –∫–æ–º–∞–Ω–¥—ã
make help

# –°—Ç–∞—Ç—É—Å –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker-compose ps

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
make stats

# –ó–∞–π—Ç–∏ –≤–Ω—É—Ç—Ä—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
make shell-bot
make shell-api
make shell-db

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–¥–æ—Ä–æ–≤—å–µ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
make health
```

---

**üéâ –ï—Å–ª–∏ –≤—Å–µ –≥–∞–ª–æ—á–∫–∏ —Å—Ç–æ—è—Ç - –ø–æ–∑–¥—Ä–∞–≤–ª—è—é, –ø—Ä–æ–µ–∫—Ç –≤ Docker —Ä–∞–±–æ—Ç–∞–µ—Ç!**

